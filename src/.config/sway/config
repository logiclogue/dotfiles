# sway config file (v4)
#
# Please see https://github.com/swaywm/sway/wiki for a complete reference!

# Required packages for Sway/Wayland:
# - wl-clipboard (clipboard utilities: wl-copy, wl-paste)
# - cliphist (clipboard manager)
# - grim, slurp (screenshot tools)
# - foot (terminal)
# - fuzzel (application launcher)
# - waybar (status bar)
# - swaylock, swayidle (screen locking and idle management)

{{> _partials/_variables}}

{{> _partials/_keybindings}}

# start a terminal
bindsym $mod+Return exec foot

# start application launcher
bindsym $mod+d exec fuzzel

# exit sway (logs you out of your Wayland session)
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

# Start waybar to display a workspace bar (plus the system information waybar
# finds out, if available)
bar {
    swaybar_command waybar
}

{{> _partials/_window_rules}}

# Jordan's stuff

# Input configuration (Wayland specific)
{{#unless mobile}}
input type:keyboard {
    xkb_layout gb
}
{{/unless}}

# Output configuration
{{#if desktop}}
output $left_screen pos 0 0
output $right_screen pos 1920 0
{{/if}}

# Idle configuration
exec swayidle -w \
    timeout 300 'swaylock -f -c $base02' \
    timeout 600 'swaymsg "output * dpms off"' resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -f -c $base02'

# Override locking command for sway
bindsym $mod+$jMod+l exec swaylock -f -c "$base02"

# Wayland-specific startup
# Note: If using swaybg, ~/.fehbg may work. Otherwise set wallpaper with:
# output * bg /path/to/wallpaper fill
exec --no-startup-id ~/.fehbg

# Clipboard manager
exec wl-paste --type text --watch cliphist store
exec wl-paste --type image --watch cliphist store

# Fcitx5 input method
exec_always fcitx5 -d --replace
exec_always --no-startup-id dbus-send --type=method_call --dest=org.fcitx.Fcitx5 /controller org.fcitx.Fcitx.Controller1.SetConfig string:fcitx://config/addon/imselector/local string:True

# Export environment variables for systemd and dbus
exec systemctl --user import-environment WAYLAND_DISPLAY DISPLAY XDG_CURRENT_DESKTOP SWAYSOCK I3SOCK XCURSOR_SIZE XCURSOR_THEME GTK_IM_MODULE QT_IM_MODULE XMODIFIERS
exec dbus-update-activation-environment WAYLAND_DISPLAY DISPLAY XDG_CURRENT_DESKTOP SWAYSOCK I3SOCK XCURSOR_SIZE XCURSOR_THEME GTK_IM_MODULE QT_IM_MODULE XMODIFIERS

# Clipboard history keybinding
bindsym $mod+i exec cliphist list | fuzzel --dmenu | cliphist decode | wl-copy

# Screenshots
bindsym Print exec grim ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png
bindsym Shift+Print exec grim -g "$(slurp)" ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png
